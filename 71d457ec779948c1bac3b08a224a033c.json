{
  "problem_type": "Rust测试should_panic属性消息匹配",
  "content": "# Rust测试should_panic属性消息匹配修复方法论\n\n## 问题重述\n当Rust测试使用`#[should_panic]`属性时，如果panic消息与预期不匹配，测试会失败。这种情况常见于：\n1. 从C代码转译到Rust时，错误消息格式不一致\n2. panic消息格式过于具体或不够具体\n3. 测试用例使用了`#[should_panic(expected = \"...\")]`但未匹配正确消息\n\n## 可复用解决流程\n\n### 步骤1：确认测试失败模式\n- 运行`cargo test 测试路径 -- --nocapture`获取完整错误信息\n- 检查测试用例是否使用`#[should_panic]`或`#[should_panic(expected = \"...\")]`\n- 对比实际panic消息与预期消息的格式差异\n\n### 步骤2：定位消息格式问题\n```bash\n# 运行特定测试用例\ncargo test test_name -- --nocapture\n\n# 或使用RUST_BACKTRACE获取更详细信息\nRUST_BACKTRACE=1 cargo test test_name\n   ```\n\n### 步骤3：修复消息格式\n根据测试用例的期望，调整panic消息：\n\n1. **简单should_panic**：移除过于具体的格式\n   ```rust\n   // 改为\n   panic!(\"invalid operands\");\n   ```\n\n2. **带expected的should_panic**：匹配精确格式\n   ```rust\n   // 测试：#[should_panic(expected = \"invalid operands\")]\n   panic!(\"invalid operands\");\n   ```\n\n### 步骤4：最小化验证\n- 优先运行单个测试：`cargo test 具体测试名`\n- 确认修复后运行完整测试：`cargo test`\n\n## 注意事项\n- 保持最小改动原则，仅修改消息格式\n- 确保不破坏原有业务逻辑\n- 如果多个测试用例依赖不同消息格式，考虑统一或分别处理\n- 注意字符串匹配是精确匹配，区分大小写\n\n## 可选步骤\n- 添加调试输出验证panic路径：`eprintln!(\"Panic path: ...\")`\n- 使用`assert_eq!`替代panic进行更细粒度测试\n- 考虑重构错误处理为Result类型，减少panic依赖"
}