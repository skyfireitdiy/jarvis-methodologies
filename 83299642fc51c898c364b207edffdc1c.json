{
  "problem_type": "C到Rust编译器转译一致性修复",
  "content": "问题重述：\n将C语言编译器转译为Rust时，需要确保：\n1. 资源管理（特别是临时文件）的一致性\n2. 全局清理机制的对应（C的atexit）\n3. 模块组织的合理性\n4. 测试覆盖的完整性\n\n可复用解决流程：\n\n步骤1：资源管理分析\n- 使用`read_code`查看C代码中的资源管理（如临时文件创建、清理）\n- 识别C中的全局清理机制（atexit注册的函数）\n- 记录所有需要清理的资源类型\n\n步骤2：实现Rust清理机制\n- 在合适模块创建cleanup函数\n- 使用全局状态（如OnceLock<Mutex<Vec>>）跟踪资源\n- 实现RAII包装器（如NamedTempFile）或手动清理\n\n步骤3：重构主函数\n- 将main拆分为real_main + cleanup包装\n- 使用catch_unwind确保panic时也执行清理\n- 在程序退出点统一调用cleanup\n\n步骤4：模块组织优化\n- 识别重复或放错位置的类型/函数\n- 创建专门的模块（如args.rs）存放相关功能\n- 更新所有引用点，保持向后兼容\n\n步骤5：测试验证\n- 运行`cargo test -- --nocapture`验证所有测试\n- 补充边界测试（多文件、错误路径、清理验证）\n- 确保无回归问题\n\n注意事项：\n- 保持最小变更，避免大范围重构\n- 确保所有临时文件都能被清理\n- 测试应包括panic场景的清理验证\n- 模块移动后更新所有use声明"
}