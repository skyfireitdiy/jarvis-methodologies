{
  "problem_type": "任务验证",
  "content": "# 任务验证方法论\n\n## 规则简介\n\n本方法论用于验证任务是否真正完成，确保任务的预期输出和产物都已实际生成且符合要求。适用于任何需要验证任务完成情况的场景。\n\n## 你必须遵守的原则\n\n### 原则1：基于实际验证，禁止推测\n\n**要求说明：**\n\n- **必须**：使用read_code和execute_script工具进行实际验证\n- **必须**：基于实际验证结果进行判断\n- **禁止**：推测或假设任务产物的存在\n- **禁止**：仅凭任务描述或代码diff判断完成情况\n\n### 原则2：逐条验证预期输出\n\n**要求说明：**\n\n- **必须**：将预期输出解析为独立的可验证条目\n- **必须**：对每一条预期输出条目分别进行验证\n- **必须**：为每条条目明确标记PASSED或FAILED状态\n- **禁止**：跳过任何一条预期输出条目的验证\n\n### 原则3：严格的完成标准\n\n**要求说明：**\n\n- **必须**：仅在所有预期输出条目都验证通过时，才判定任务完成\n- **必须**：如果任意一条条目验证失败，整体判定为未完成\n- **必须**：对失败条目提供详细的失败原因和修复建议\n- **禁止**：部分完成即判定为任务完成\n\n## 你必须执行的操作\n\n### 阶段1：解析预期输出\n\n1. **识别预期输出格式**：\n   - 检查预期输出是否按编号（1)、2)、3)）或列表（- item）格式组织\n   - 识别每条预期输出的具体要求\n\n2. **拆分为独立条目**：\n   - 将预期输出按换行、编号或列表标记拆分为独立条目\n   - 为每条条目编号，便于后续追踪\n\n3. **理解验证要求**：\n   - 明确每条条目需要验证的具体内容\n   - 确定需要使用的验证工具和方法\n\n### 阶段2：逐条验证\n\n对每一条预期输出条目执行以下步骤：\n\n1. **文件存在性验证**：\n   - 使用execute_script工具检查文件是否存在\n   - 示例：`ls -la <文件路径>` 或 `test -f <文件路径> && echo \"exists\"`\n\n2. **代码内容验证**：\n   - 使用read_code工具读取文件内容\n   - 验证关键代码结构、类定义、方法实现等\n   - 检查是否符合条目描述的要求\n\n3. **功能完整性验证**：\n   - 使用execute_script执行相关检查命令\n   - 示例：统计测试数量 `rg -c 'def test_' <测试文件>`\n   - 示例：运行测试 `pytest <测试文件> -v`\n   - 示例：类型检查 `mypy <源文件> --strict`\n\n4. **记录验证结果**：\n   - 为每条条目标记状态：✅ PASSED 或 ❌ FAILED\n   - 如果失败，记录详细的失败原因\n\n### 阶段3：汇总验证结果\n\n1. **生成验证报告**：\n   - 列出所有预期输出条目及其验证状态\n   - 对每条条目提供验证依据（工具输出、代码片段等）\n\n2. **判定整体完成状态**：\n   - 检查是否所有条目都标记为PASSED\n   - 如果全部通过，输出 `<!!!COMPLETE!!!>`\n   - 如果有任何失败，说明失败原因和修复建议\n\n3. **提供修复建议**（如果验证失败）：\n   - 分析失败原因\n   - 提供具体的修复步骤\n   - 说明如何达到验证标准\n\n## 实践指导\n\n### 最佳实践\n\n1. **使用批量工具调用**：\n   - 对于无依赖关系的验证操作，可以一次调用多个工具\n   - 示例：同时检查文件存在性和统计测试数量\n\n2. **优先验证基础条目**：\n   - 先验证文件是否存在\n   - 再验证文件内容是否符合要求\n   - 最后验证功能是否正常\n\n3. **保留验证证据**：\n   - 在验证报告中引用实际的工具输出\n   - 提供代码行号和具体内容\n   - 便于追溯和复查\n\n### 常见错误\n\n1. **仅凭代码diff判断**：\n   - 错误：看到diff中有相关代码就认为任务完成\n   - 正确：使用read_code实际读取文件验证\n\n2. **跳过某些条目**：\n   - 错误：认为某些条目\"显然已完成\"而跳过验证\n   - 正确：对每条预期输出都进行实际验证\n\n3. **部分完成即判定通过**：\n   - 错误：大部分条目通过就判定任务完成\n   - 正确：必须所有条目都通过才能判定完成\n\n### 注意事项\n\n1. **测试执行环境**：\n   - 确保在正确的工作目录执行测试\n   - 注意Python环境和依赖是否正确\n\n2. **类型检查严格性**：\n   - 如果任务要求mypy检查无警告，使用`--strict`模式\n   - 注意区分错误和警告\n\n3. **测试数量统计**：\n   - 使用准确的模式匹配（如`def test_`）\n   - 避免统计到非测试函数\n\n## 检查清单\n\n验证完成后，确认以下事项：\n\n- [ ] 已将预期输出解析为独立的可验证条目\n- [ ] 对每条预期输出条目都进行了实际验证\n- [ ] 每条条目都有明确的PASSED或FAILED状态\n- [ ] 验证报告包含实际的工具输出作为证据\n- [ ] 如果有失败条目，提供了详细的失败原因和修复建议\n- [ ] 仅在所有条目通过时才判定任务完成\n- [ ] 如果任务完成，输出了`<!!!COMPLETE!!!>`标记",
  "scope": "global"
}