{
  "problem_type": "代码重构前函数删除分析",
  "content": "问题重述：\n在代码重构前，需要安全地删除一批特定模式的函数（如 _collect_*_config 和 _ask_config_*），需要确认这些函数的位置、调用关系以及删除的安全性，避免破坏现有功能。\n\n可复用解决流程：\n\n步骤1：定位目标函数\n- 使用 grep 或 rg 搜索目标函数定义\n  ```bash\n  grep -n \"^def <函数模式>\" <目标文件>\n  ```\n- 统计函数数量，确认与预期一致\n\n步骤2：确定函数行号范围\n- 使用 read_code 工具读取目标文件的相关行范围\n- 分析函数结构，确定每个函数的起始和结束行号\n- 或者使用 awk 脚本自动计算：\n  ```bash\n  awk '/^def <函数模式>/ {start = NR; name = $0} /^def / && NR != start {print name \" 行号范围: \" start \" - \" (NR-1); start = NR; name = $0} END {print name \" 行号范围: \" start \" - \" NR}' <目标文件>\n  ```\n\n步骤3：分析调用关系\n- 搜索每个目标函数的被调用情况：\n  ```bash\n  grep -n \"<函数名>\" <目标文件> | grep -v \"^def\"\n  ```\n- 确认调用者是否都是预期的父函数\n- 检查是否有外部文件调用这些函数：\n  ```bash\n  grep -rn \"<函数名>\" <项目根目录>/ --exclude-dir=<排除目录>\n  ```\n\n步骤4：确认删除安全性\n- 验证所有目标函数是否仅被预期的父函数调用\n- 确认父函数（如 _collect_optional_config_interactively）也将被替换或删除\n- 检查是否有测试文件依赖这些函数\n\n步骤5：生成删除清单\n- 汇总函数列表及行号范围\n- 记录调用关系分析结果\n- 确认可以安全删除的函数\n\n注意事项：\n- 排除缓存目录（如 __pycache__、.mypy_cache）和二进制文件\n- 区分函数定义和函数调用\n- 确认父函数的调用者，避免删除后影响其他代码\n- 保留行号信息，便于后续手动或自动删除\n\n可选步骤：\n- 如果需要批量删除，可以根据行号范围使用 sed 或其他工具\n- 建议先删除函数内容，留下空函数作为占位符，运行测试确认后再完全删除\n- 使用 git diff 查看变更范围"
}