{
  "problem_type": "Python函数参数增强",
  "content": "# Python函数可选参数增强模式\n\n## 问题描述\n需要在现有函数基础上添加增强功能（如日志输出、性能监控等），但必须保持向后兼容，不能破坏已有调用代码。\n\n## 可复用解决流程\n\n### 1. 添加可选参数\n```python\ndef original_function(param1, param2):\n    # 原有逻辑\n    pass\n\n# 改进为\ndef enhanced_function(param1, param2, enhanced_param: str | None = None):\n    # 原有逻辑 + 增强功能\n    pass\n```\n\n### 2. 条件性执行增强功能\n```python\ndef enhanced_function(param1, param2, enhanced_param: str | None = None):\n    # 原有逻辑\n    result = do_something(param1, param2)\n   \n    # 增强功能（仅在参数提供时执行）\n    if enhanced_param:\n        # 执行增强逻辑\n        print(f\"Processing {enhanced_param}\")\n   \n    return result\n```\n\n### 3. 调用方渐进式升级\n```python\n# 旧代码无需修改，继续工作\nresult = enhanced_function(a, b)\n\n# 新代码可以使用增强功能\nresult = enhanced_function(a, b, enhanced_param=\"rule_name\")\n```\n\n## 关键原则\n\n1. **向后兼容优先**：新参数必须有默认值（通常为 None）\n2. **可选参数放在最后**：保持函数签名的可读性\n3. **类型注解清晰**：使用 Optional[T] 或 T | None 明确表示可选性\n4. **文档更新**：在 docstring 中说明新参数的用途和影响\n5. **统一输出格式**：使用项目的标准输出工具（如 PrettyOutput.auto_print）而非 print\n\n## 注意事项\n\n- 避免过度设计：如果只有一个调用方需要增强，考虑直接修改而非添加参数\n- 考虑性能影响：增强逻辑应轻量，避免显著影响函数性能\n- 线程安全：增强功能如涉及共享状态，需考虑并发访问\n- 日志级别：区分调试信息、信息、警告等，避免关键路径输出过多\n\n## 应用场景\n\n- 添加操作成功提示\n- 添加性能计时\n- 添加详细日志\n- 添加回调通知\n- 添加调试信息输出\n- 添加统计计数",
  "scope": "global"
}