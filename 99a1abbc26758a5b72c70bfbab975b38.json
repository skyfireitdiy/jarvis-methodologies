{
  "problem_type": "CLI参数传递链修复",
  "content": "# CLI 参数传递链修复\n\n## 问题重述\n当使用 CLI 参数（如 `-g/--llm-group`）传递配置时，某些功能（如欢迎信息、日志输出）显示的值与传入的参数不一致。这是因为参数在调用链中没有正确传递到所有需要使用该参数的函数。\n\n## 可复用解决流程\n\n### 步骤 1：定位问题源头\n1. 从 CLI 入口开始追踪参数传递路径\n2. 找到显示信息不准确的函数（如 `_show_usage_stats`）\n3. 检查该函数调用时是否传入了正确的参数\n\n### 步骤 2：修改函数签名\n1. 在目标函数签名中添加参数（如 `model_group_override`）\n2. 添加参数文档说明其用途\n3. 确保参数默认值为 `None` 以保持向后兼容\n\n### 步骤 3：更新函数内部逻辑\n1. 在调用获取配置的函数时传入该参数（如 `get_normal_model_name(model_group_override)`）\n2. 确保参数优先级正确：传入参数 > 全局配置 > 配置文件 > 默认值\n\n### 步骤 4：追溯并更新所有调用点\n1. 搜索所有调用目标函数的地方\n2. 检查每个调用点的上下文，确定是否有可用的参数\n3. 更新调用点传入正确的参数\n\n### 步骤 5：验证修改\n1. 运行 CLI 命令，使用参数测试\n2. 检查输出信息是否正确显示\n3. 确保没有破坏现有功能（如不带参数运行）\n\n## 注意事项\n1. **参数命名一致性**：在不同函数中参数名称应保持一致或清晰表明其用途（如 `model_group` vs `model_group_override`）\n2. **向后兼容**：所有新增参数应有默认值，确保不破坏现有调用\n3. **参数优先级**：明确参数优先级，通常为：显式传入 > 全局配置 > 配置文件 > 代码默认值\n4. **全局配置同步**：在 `init_env()` 之前使用 `set_config()` 同步 CLI 参数到全局配置\n5. **静态检查**：修改后运行静态检查工具（如 mypy）确保类型正确\n\n## 可选步骤\n1. 添加单元测试覆盖参数传递场景\n2. 在文档中记录参数传递链\n3. 考虑使用装饰器或上下文管理器简化参数传递（适用于复杂场景）\n\n## 相关技术点\n- 函数参数传递\n- 配置优先级管理\n- CLI 参数处理（Typer/Click）\n- 全局状态管理（GLOBAL_CONFIG_DATA）\n- 参数覆盖策略",
  "scope": "global"
}