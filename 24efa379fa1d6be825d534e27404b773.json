{
  "problem_type": "Python CLI 工具开发",
  "content": "# Python CLI 工具开发方法论\n\n## 问题重述\n使用 Python 开发命令行工具，需要实现用户交互、API 调用、错误处理等功能。\n\n## 可复用解决流程\n\n### 1. 项目结构设计\n- 创建项目主目录（如 `~/code/xxx-cli/`）\n- 创建源码目录 `src/`\n- 创建依赖文件 `requirements.txt`\n- 创建 `README.md` 文档\n\n### 2. 选择 CLI 框架\n- 推荐使用 **typer**：简洁易用，自动生成帮助信息\n- 备选方案：click（功能更强大，但配置更复杂）\n\n### 3. 代码结构设计\n```python\n#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\nimport getpass\nfrom typing import Optional\nimport requests\nimport typer\n\napp = typer.Typer(help=\"工具描述\")\n\n# 常量定义\nAPI_URL = \"https://api.example.com\"\n\n# 核心业务类\nclass BusinessClient:\n    \"\"\"业务逻辑封装类\"\"\"\n    def __init__(self, token: Optional[str] = None):\n        self.token = token\n   \n    def perform_operation(self, ...) -> bool:\n        \"\"\"执行具体业务操作\"\"\"\n        pass\n\n# CLI 命令定义\n@app.command()\ndef main_command(\n    param: str = typer.Option(..., \"--param\", \"-p\", help=\"参数说明\"),\n    username: Optional[str] = typer.Option(None, \"--username\", \"-u\", help=\"用户名\")\n):\n    \"\"\"命令说明\"\"\"\n    # 交互式输入处理\n    if not username:\n        username = typer.prompt(\"请输入用户名\")\n   \n    # 业务逻辑调用\n    client = BusinessClient()\n    result = client.perform_operation(param)\n   \n    if result:\n        typer.echo(\"✓ 操作成功\")\n    else:\n        typer.echo(\"✗ 操作失败\")\n        raise typer.Exit(code=1)\n\nif __name__ == \"__main__\":\n    app()\n```\n\n### 4. 功能模块实现\n- **认证模块**：实现登录、Token 获取、签名生成\n- **API 调用模块**：封装 requests 请求，处理 JSON 数据\n- **错误处理**：网络异常、超时、API 错误响应\n\n### 5. 依赖管理\n在 `requirements.txt` 中明确指定依赖版本：\n```\ntyper[all]>=0.9.0\nrequests>=2.31.0\n```\n\n## 注意事项\n\n### 安全性\n- 禁止在代码中硬编码用户名密码\n- 使用 `getpass` 模块安全输入密码\n- 不要提交临时文件或测试数据\n\n### 错误处理\n- 捕获 `requests.exceptions.Timeout`：请求超时\n- 捕获 `requests.exceptions.ConnectionError`：网络连接错误\n- 捕获通用异常并友好提示\n- 设置合理的超时时间（如 30 秒）\n\n### 用户体验\n- 使用 typer 的 Option 参数类型提示\n- 提供清晰的帮助信息（help 参数）\n- 交互式输入使用 typer.prompt 或 getpass\n- 操作状态提示：✓ 成功，✗ 失败\n\n### 代码质量\n- 遵循 PEP 8 编码规范\n- 为类和函数添加详细的文档字符串（Args/Returns）\n- 使用类型注解提高代码可读性\n- 进行语法检查：`python -m py_compile module.py`\n\n### 验证标准\n- 代码语法正确，可通过 py_compile 检查\n- 模块可正常导入：`python -c \"from src.module import ClassName\"`\n- 所有依赖在 requirements.txt 中已列出\n- 命令行帮助信息正常显示\n\n## 可选步骤\n- 添加单元测试（使用 pytest）\n- 添加日志记录（使用 logging 模块）\n- 配置文件支持（使用 configparser 或 pydantic）\n- 创建安装脚本（setup.py 或 pyproject.toml）",
  "scope": "global"
}