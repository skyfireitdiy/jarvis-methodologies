{
  "problem_type": "Rust全局状态测试失败调试",
  "content": "问题重述：\n当测试全局状态（如TMPFILES列表）时，测试断言失败，尽管实现代码看起来正确。需要系统性地定位和解决这类问题。\n\n可复用解决流程：\n1. **验证基础代码**：\n   - 检查create_tmpfile函数是否确实调用了TMPFILES.lock().unwrap().push()\n   - 确认路径格式和标准化\n\n2. **测试隔离检查**：\n   - 使用reset_tmpfiles()在每个测试前清理状态\n   - 验证清理函数是否正确清空列表和删除文件\n\n3. **并发调试**：\n   - 单独运行失败测试：`cargo test test_name -- --nocapture`\n   - 检查是否有并发访问问题\n\n4. **路径比较验证**：\n   - 打印实际路径和期望路径进行对比\n   - 检查路径标准化差异（如尾部斜杠、相对路径等）\n\n5. **状态验证**：\n   - 在测试中添加调试输出，显示TMPFILES内容\n   - 验证测试执行顺序和状态清理\n\n注意事项：\n- 全局状态测试容易受到并发执行影响\n- 路径字符串比较需注意大小写和格式差异\n- 使用Mutex时考虑锁的获取和释放时机\n\n可选步骤：\n- 考虑使用测试隔离技术，如测试文件分隔\n- 实现更robust的状态清理机制"
}