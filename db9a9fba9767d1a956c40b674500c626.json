{
  "problem_type": "install_script_mirror_fallback",
  "content": "## 问题重述\n在安装脚本（install.sh）中实现镜像源降级策略，优先尝试国内镜像源（如 Gitee），失败后自动回退到官方源（如 GitHub），确保在各种网络环境下都能成功安装。\n\n## 可复用解决流程\n\n### 步骤1：定义镜像源变量\n在脚本顶部定义多个镜像源变量，添加注释说明优先级：\n```bash\n# Define repo URLs and destination directory\n# 优先尝试 Gitee 镜像（国内访问更快），失败后回退到 GitHub\nGITEE_URL=\"https://gitee.com/user/project.git\"\nGITHUB_URL=\"https://github.com/user/project.git\"\nDEST_DIR=\"$HOME/Project\"\n```\n\n### 步骤2：实现降级克隆逻辑\n使用嵌套 if 条件实现顺序尝试，临时禁用 `set -e` 以允许错误继续：\n```bash\n        else\n    echo \"正在克隆仓库到 $DEST_DIR...\"\n    # 临时禁用 set -e 以允许降级重试\n    set +e\n    if git clone \"$GITEE_URL\" \"$DEST_DIR\"; then\n        echo \"✓ Gitee 镜像克隆成功\"\n        else\n        echo \"✗ Gitee 镜像克隆失败，尝试从 GitHub 克隆...\"\n        if git clone \"$GITHUB_URL\" \"$DEST_DIR\"; then\n            echo \"✓ GitHub 克隆成功\"\n        else\n            echo \"✗ GitHub 克隆也失败，请检查网络连接或手动下载\"\n    set -e\n            exit 1\nfi\nfi\n    set -e\nfi\n```\n\n### 步骤3：验证脚本语法\n使用 bash 语法检查确保脚本无错误：\n```bash\nbash -n scripts/install.sh\n```\n\n## 注意事项\n1. **错误处理**：必须恢复 `set -e`，否则会影响后续脚本的错误检测\n2. **退出状态**：所有镜像源都失败时必须 exit 1，避免继续执行\n3. **用户提示**：每次尝试都给出明确的成功/失败提示（✓/✗）\n4. **保持兼容**：确保现有功能（如目录已存在时的更新逻辑）不受影响\n\n## 可选扩展\n1. 支持更多镜像源（如 GitLab、Bitbucket）\n2. 添加超时控制（使用 git clone --timeout）\n3. 记录失败原因到日志文件",
  "scope": "global"
}