{
  "problem_type": "修复Rust构建脚本unwrap错误处理",
  "content": "## 问题重述\n修复Rust构建脚本(build.rs)中使用unwrap()导致的潜在panic问题，将unwrap()替换为expect()并提供有意义的错误信息，确保构建失败时提供清晰的错误描述。\n\n## 可复用解决流程\n\n### 步骤1：定位问题\n使用read_code工具读取构建脚本文件，查找所有unwrap()调用：\n```bash\nrg 'unwrap\\(\\)' build.rs\n```\n\n### 步骤2：分析每个unwrap()的使用场景\n- 环境变量读取：`env::var_os()` / `env::var()`\n- 文件系统操作：`fs::canonicalize()` / `fs::read_to_string()`\n- 路径操作：`env::join_paths()` / `Path::to_str()`\n\n### 步骤3：替换为expect()并提供错误信息\n根据具体场景提供有意义的错误描述：\n\n- **环境变量失败**：`expect(\"环境变量XXX未设置\")`\n- **路径规范化失败**：`expect(\"无法规范化路径：XXX\")`\n- **路径拼接失败**：`expect(\"无法拼接路径：XXX\")`\n- **字符串转换失败**：`expect(\"路径包含无效UTF-8字符\")`\n\n### 步骤4：验证修复\n使用cargo check验证：\n```bash\ncargo check\n```\n\n## 注意事项\n1. 构建脚本的错误应该导致构建失败，而非静默处理\n2. 错误信息应该具体到操作和上下文，便于开发者定位\n3. 保持构建脚本的核心逻辑不变，仅改进错误处理\n4. 确保所有替换后的代码能通过编译检查\n\n## 修复示例\n\n**修复前：**\n```rust\nlet root = PathBuf::from(env::var_os(\"CARGO_MANIFEST_DIR\").unwrap());\nlet lib_dir = fs::canonicalize(root.join(\"lib\")).unwrap();\nlet path_str = env::join_paths([lib_dir]).unwrap().to_str().unwrap();\n```\n\n**修复后：**\n```rust\nlet root = PathBuf::from(\n    env::var_os(\"CARGO_MANIFEST_DIR\")\n        .expect(\"CARGO_MANIFEST_DIR environment variable not set\")\n);\nlet lib_dir = fs::canonicalize(root.join(\"lib\"))\n    .expect(\"failed to canonicalize library directory path\");\nlet path_str = env::join_paths([lib_dir])\n    .expect(\"failed to join library paths\")\n    .to_str()\n    .expect(\"library path contains invalid UTF-8\");\n```"
}