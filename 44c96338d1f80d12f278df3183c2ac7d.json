{
  "problem_type": "C到Rust编译器移植修复",
  "content": "# C到Rust编译器移植修复方法论\n\n## 问题重述\n在将C编译器移植到Rust时，需要解决功能一致性、类型系统完善、语法解析增强等问题。\n\n## 可复用解决流程\n\n### 阶段1：需求分析与定位\n1. **代码审查**：获取C源码和Rust实现，对比功能差异\n   - 使用read_code读取目标函数\n   - 使用lsp_client分析符号依赖\n   - 识别缺失功能vs实现差异\n\n2. **测试覆盖分析**\n   - 运行cargo test识别失败测试\n   - 分析现有测试用例覆盖范围\n   - 规划需要补充的测试场景\n\n### 阶段2：功能修复实施\n1. **类型系统增强**（优先级高）\n   - 增强declspec支持复合类型：unsigned long long、const volatile int\n   - 实现Qualifier状态机：signed/unsigned/const/volatile\n   - 支持嵌套类型：指针、数组、函数指针\n\n2. **语法解析完善**\n   - 多维数组：int arr[3][4] → Type::Array(Array(Int, 4), 3)\n   - 复杂指针：int * const ptr → Pointer(Const(Int))\n   - 函数指针：int (*fp)(int,int) → Pointer(Function)\n\n3. **测试用例补充**\n   - 基础类型测试：void、char、int、long、float、double\n   - 复合类型测试：unsigned long long、const int\n   - 数组测试：一维、二维、可变长度\n   - 指针测试：普通指针、函数指针、const指针\n\n### 阶段3：验证与清理\n1. **构建验证**\n   ```bash\n   cargo build --lib\n   cargo test --lib\n   ```\n\n2. **回归测试**\n   - 确保新功能不破坏现有测试\n   - 验证所有边界情况\n   - 性能测试（可选）\n\n### 注意事项\n- 保持最小变更，避免大重构\n- 优先修复导致测试失败的问题\n- 每次提交前运行全量测试\n- 注释使用中文\n- 避免引入新依赖\n\n### 可选步骤\n- 性能优化：类型缓存、解析加速\n- 错误处理：友好的语法错误提示\n- 扩展：支持更多C99/C11特性"
}