{
  "problem_type": "规则库迁移",
  "content": "# 规则库迁移（TDD方法）\n\n## 问题重述\n将大型检查器文件中的规则库独立到单独文件，实现关注点分离，提高代码可维护性。核心挑战是确保迁移过程中功能完全不变。\n\n## 可复用解决流程\n\n### 阶段1：红（Red）- 编写测试\n1. **分析现有规则**：识别所有规则名称、正则表达式和编译标志\n2. **创建测试文件**：为每个规则编写测试用例\n   - 验证规则类型为 re.Pattern\n   - 验证规则能匹配预期字符串\n   - 按规则类组织测试\n3. **运行测试**：确保所有测试通过，确认规则功能完整\n\n### 阶段2：绿（Green）- 创建规则库\n1. **创建独立规则文件**：按架构设计创建新文件\n2. **按类别组织规则类**：\n   - BaseRules: 基础不安全API\n   - FormatCommandRules: 格式化字符串和命令执行\n   - ThreadRules: 线程和同步\n   - CppLockRules: C++标准库锁\n   - DataRaceRules: 数据竞争检测\n   - DangerousUsageRules: 危险用法\n   - MemoryHelperRules: 内存管理辅助\n   - CppSpecificRules: C++特定模式\n   - HelperRules: 辅助规则\n3. **迁移规则**：逐个迁移正则表达式，保持编译标志不变\n4. **添加文档**：为每个规则类添加清晰的文档注释\n5. **验证测试**：运行测试确保所有规则正确迁移\n\n### 阶段3：重构 - 解耦检查逻辑\n1. **更新原文件**：删除已迁移的规则定义\n2. **更新导入**：从新规则库文件导入规则\n3. **验证功能**：运行完整测试套件确保功能不变\n\n## 注意事项\n1. **禁止修改规则内容**：所有正则表达式必须保持原样\n2. **保持编译标志**：re.IGNORECASE等编译标志必须保留\n3. **测试驱动**：先编写测试，再进行迁移\n4. **小步快跑**：每步修改后立即验证\n5. **不遗漏规则**：确保所有规则都被迁移（通过测试数量验证）\n\n## 可选步骤\n1. 添加规则使用统计和覆盖率分析\n2. 为规则添加置信度评分机制\n3. 创建规则配置文件支持动态加载\n\n## 验收标准\n1. 测试覆盖率 >= 80%\n2. 所有测试通过\n3. 原检查器文件行数显著减少\n4. 规则库可独立扩展",
  "scope": "global"
}