{
  "problem_type": "Cargo配置清理",
  "content": "# Cargo.toml配置清理方法论\n\n## 规则简介\n\n本方法论用于批量清理Rust项目中Cargo.toml文件的特定配置节，适用于删除不再需要的patch、workspace等配置项，保持项目配置文件的简洁性。\n\n## 你必须遵守的原则\n\n### 安全性原则\n\n**要求说明：**\n- **必须**：在修改前备份重要文件或确认git版本控制可用\n- **必须**：先扫描确认要修改的文件列表，避免误修改\n- **必须**：精确匹配要删除的配置节，避免删除其他内容\n- **禁止**：在生产环境中直接批量修改，先在测试环境验证\n\n### 精确性原则\n\n**要求说明：**\n- **必须**：使用精确的文本匹配，识别配置节的开始和结束\n- **必须**：保留其他节的完整内容，包括[package]、[dependencies]等\n- **必须**：处理嵌套节的情况（如[patch.crates-io]是[patch]的子节）\n- **禁止**：使用正则表达式进行模糊匹配，可能导致误删除\n\n## 你必须执行的操作\n\n### 阶段1：准备和扫描\n\n1. **扫描目标目录**：使用find或fd命令查找所有需要修改的Cargo.toml文件\n2. **识别包含目标节的文件**：使用grep过滤出包含目标配置节的文件\n3. **确认修改范围**：列出所有将要修改的文件，等待确认\n\n### 阶段2：精确删除\n\n对于每个包含目标配置节的文件：\n\n1. **读取完整内容**：使用read_code工具读取文件内容\n2. **识别配置节位置**：\n   - 找到`[patch]`或`[patch.xxx]`的开始位置\n   - 找到下一个`[...]`节的开始位置（作为结束位置）\n3. **精确删除**：\n   - 删除`[patch]`或`[patch.xxx]`行\n   - 删除该节下的所有内容\n   - 保留后续的其他节内容\n4. **验证格式**：确保删除后文件格式正确，无多余的空行\n\n### 阶段3：验证和回滚\n\n1. **验证修改结果**：使用grep确认目标配置节已被完全删除\n2. **验证文件完整性**：检查Cargo.toml文件语法是否正确\n3. **准备回滚方案**：记录git commit ID，确保可以回滚\n\n## 实践指导\n\n### 常见配置节删除模式\n\n**删除[patch]节**：\n```bash\n# 识别文件\ngrep -l \"\\\\[patch\" path/to/*/Cargo.toml\n\n# 手动删除时，删除以下内容：\n[patch]\n\n[patch.crates-io]\ncrate_name = { path = \"...\" }\n...\n```\n\n**删除workspace成员**：\n```bash\n# 识别文件\ngrep -l \"workspace\" path/to/*/Cargo.toml\n\n# 删除以下内容：\n[workspace]\nmembers = [\"...\"]\n```\n\n### 批量处理技巧\n\n1. **先小范围测试**：先处理1-2个文件，验证效果后再批量处理\n2. **使用版本控制**：确保所有修改都已提交，便于回滚\n3. **分批提交**：每批文件修改后立即提交，避免批量失败\n4. **记录日志**：记录修改的文件清单和修改时间\n\n## 检查清单\n\n### 修改前检查\n\n- [ ] 已确认目标目录和文件列表\n- [ ] 已备份或确认git版本控制可用\n- [ ] 已理解要删除的配置节的完整格式\n- [ ] 已准备回滚方案\n\n### 修改中检查\n\n- [ ] 每个文件修改后立即验证\n- [ ] 确认只删除了目标配置节\n- [ ] 确认其他节内容完整\n- [ ] 文件格式正确，无多余空行\n\n### 修改后检查\n\n- [ ] 所有目标文件中的配置节已删除\n- [ ] Cargo.toml文件语法正确\n- [ ] 项目可以正常构建（如果需要）\n- [ ] 已提交所有修改到git",
  "scope": "global"
}