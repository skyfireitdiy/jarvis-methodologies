{
  "problem_type": "C转译功能一致性验证",
  "content": "# C转译功能一致性验证方法论\n\n## 问题重述\n当将C代码转译为Rust时，需要确保转译后的代码在行为上与原始C实现完全一致，包括：\n- 文件系统操作行为\n- 错误处理机制\n- 搜索算法逻辑\n- 测试环境行为一致性\n\n## 可复用解决流程\n\n### 步骤1：行为识别\n- 分析C实现的关键行为特性\n- 识别文件系统交互模式\n- 记录错误处理路径\n\n### 步骤2：差异分析\n- 比较C实现与Rust实现的差异点\n- 特别关注测试环境的特殊处理\n- 检查文件系统操作的行为一致性\n\n### 步骤3：测试设计\n1. **单元测试**：使用mock/fake测试函数行为\n2. **集成测试**：使用tempfile创建真实文件系统测试\n3. **行为验证**：确保glob模式匹配、文件查找顺序等符合预期\n\n### 步骤4：一致性修复\n- 移除测试环境特殊分支\n- 统一错误处理行为\n- 确保文件系统操作与C实现一致\n\n### 步骤5：验证\n- 运行所有测试用例\n- 验证测试用例设计覆盖了所有关键行为\n- 确保无回归问题\n\n## 工具使用组合\n- `tempfile`库：创建可控的临时文件系统\n- `globwalk`库：实现glob模式匹配\n- `#[should_panic]`属性：测试panic行为\n- 分层测试策略：单元测试+集成测试\n\n## 注意事项\n1. **行为一致性优先**：不要为了保持测试通过而修改核心逻辑\n2. **测试隔离**：使用临时目录避免污染真实文件系统\n3. **错误处理统一**：生产环境和测试环境行为必须一致\n4. **边界情况**：测试无匹配、多匹配、顺序匹配等场景\n\n## 可选步骤\n- 添加性能测试比较C与Rust实现的效率差异\n- 创建行为文档记录关键实现决策\n- 添加错误场景的压力测试"
}