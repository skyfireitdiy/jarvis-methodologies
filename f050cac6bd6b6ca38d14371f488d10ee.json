{
  "problem_type": "批量处理资源限制优化",
  "content": "## 问题重述\n在批量处理任务中（如网页抓取、API调用、数据加载等），当达到资源限制（token限制、内存限制、时间限制等）时，如何避免继续处理造成资源浪费。\n\n## 可复用解决流程\n\n### 步骤1：识别资源限制点\n在批量处理的循环中，识别需要检查资源限制的位置，通常在每次迭代开始或处理每个项目之前。\n\n### 步骤2：检查资源限制\n计算或检测当前资源使用情况，判断是否已达到或接近限制阈值。\n\n### 步骤3：检查有效性并决策\n在检测到资源限制后，检查是否已有成功获取的有效结果：\n- **如果有有效结果**：立即终止批量处理（使用 `break`），记录日志说明终止原因\n- **如果无有效结果**：可以尝试继续处理或记录警告（使用 `continue`），视具体需求决定\n\n### 步骤4：提供清晰日志\n输出包含以下信息的日志：\n- 触发条件（如\"内容长度已达限制\"）\n- 已完成的处理数量（如\"已成功获取 3 个网页内容\"）\n- 决策结果（如\"停止获取后续网页\"）\n\n### 代码模式示例\n```python\nfor item in items:\n    # 检查资源限制\n    if remaining_limit <= 0:\n        # 已有有效结果，终止处理\n        if visited_count > 0:\n            print(f\"⚠️ 资源已达限制且已成功获取 {visited_count} 项内容，停止后续处理\")\n            break\n        # 无有效结果，跳过当前项\n        print(f\"⚠️ 资源已达限制，跳过: {item}\")\n        continue\n   \n    # 处理当前项\n    process_item(item)\n    visited_count += 1\n```\n\n## 注意事项\n1. **资源检查时机**：应在处理每个项目之前进行检查，避免浪费资源\n2. **有效性定义**：明确什么算作\"有效结果\"（如成功抓取、解析通过等）\n3. **日志完整性**：日志应包含足够的上下文信息，便于问题排查\n4. **性能考虑**：资源计算本身不应成为性能瓶颈，使用高效的计数方法\n\n## 可选步骤\n- 记录被跳过的项目列表，便于后续重试\n- 添加资源使用统计和报告\n- 实现渐进式降级策略（先处理高优先级项目）\n\n## 适用场景\n- 网页抓取和内容聚合\n- 批量API调用\n- 大文件分块读取\n- 数据库批量查询\n- 任何受资源限制的批量处理任务",
  "scope": "global"
}