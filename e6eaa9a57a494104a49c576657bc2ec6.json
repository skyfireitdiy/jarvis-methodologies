{
  "problem_type": "Rust测试should_panic不匹配修复",
  "content": "# Rust测试should_panic不匹配修复方法论\n\n## 问题重述\n当Rust测试使用`#[should_panic]`宏时，如果期望的错误信息与实际的panic信息不完全匹配，会导致测试失败。\n\n## 可复用解决流程\n\n### 步骤1：定位失败测试\n```bash\ncargo test -- --nocapture\n```\n- 记录失败的测试用例名称\n- 记录实际的panic信息\n\n### 步骤2：分析期望与实际的差异\n- 对比`#[should_panic(expected = \"...\")]`中的字符串\n- 与实际panic输出的\"panicked at\"行进行对比\n- 确认是完全不匹配还是部分不匹配\n\n### 步骤3：查看测试代码\n```bash\n# 查看具体测试用例\nread_code -f src/xxx.rs -l [测试行号-5, 测试行号+5]\n```\n\n### 步骤4：修复方案选择\n**方案A（推荐）**：修改测试期望\n- 当panic信息正确，测试期望过时时使用\n- 保持核心逻辑不变，仅更新期望字符串\n\n**方案B**：修改实现代码\n- 当panic信息不正确，需要调整错误处理逻辑时使用\n\n### 步骤5：实施修复\n```bash\n# 修改测试用例的should_panic期望\nedit_file -f src/xxx.rs \\\n  -s '[原should_panic行]' \\\n  -r '[新should_panic行]'\n```\n\n### 步骤6：验证修复\n```bash\ncargo test --test [测试名]\n# 或\ncargo test --quiet\n```\n\n## 注意事项\n1. 优先选择方案A（修改测试期望），除非实现逻辑确实有问题\n2. 修改前应确保panic信息的正确性\n3. 在C转Rust项目中，注意保持错误信息格式的一致性\n4. 修复后应运行全部测试，避免引入回归问题\n\n## 可选步骤\n- 使用`cargo test -- --nocapture <测试名>`单独运行特定测试\n- 添加临时调试输出确认panic发生位置\n- 使用git diff确认修改范围"
}