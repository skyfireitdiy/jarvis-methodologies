{
  "problem_type": "C到Rust函数转换",
  "content": "# C到Rust函数转换方法论\n\n## 问题重述\n需要将C语言的系统级函数转换为等效的Rust实现，同时保持功能一致性和内存安全。\n\n## 可复用解决流程\n\n### 阶段1：需求分析\n1. **使用read_code读取C源码** - 理解原始实现\n2. **使用lsp_client查找符号** - 定位相关依赖\n3. **识别关键数据结构** - 标记需要转换的结构体类型\n\n### 阶段2：结构设计\n1. **创建Rust结构体** - 映射C的struct到Rust的struct\n2. **实现基本方法** - 添加new()、default()等构造函数\n3. **添加功能方法** - 实现C函数的等效Rust方法\n\n### 阶段3：功能实现\n1. **处理内存安全**：\n   - 使用Vec代替malloc/free\n   - 使用Result<(), Error>代替错误码\n   - 使用Option代替空指针检查\n2. **处理借用检查器**：\n   - 提前提取需要的数据避免重复借用\n   - 使用collect()收集迭代结果\n   - 必要时使用clone()避免生命周期问题\n3. **保持行为一致**：\n   - 使用相同的状态机逻辑\n   - 保留关键的边界检查\n   - 保持相同的错误处理路径\n\n### 阶段4：测试验证\n1. **使用execute_script运行cargo test**\n2. **设计边界测试用例**：\n   - 空输入测试\n   - 极端值测试\n   - 错误路径测试\n3. **验证功能一致性**：\n   - 对比C和Rust的输出结果\n   - 测试相同的边界条件\n\n### 阶段5：代码整理\n1. **清理未使用的导入**\n2. **修复编译警告**\n3. **添加中文注释**\n4. **保持代码风格一致\n\n## 注意事项\n- 避免直接使用unsafe代码块\n- 优先使用标准库功能\n- 确保所有路径都有返回值\n- 保持方法签名的简洁性\n\n## 可选步骤\n- 添加性能基准测试\n- 添加文档示例\n- 实现更完整的错误类型"
}