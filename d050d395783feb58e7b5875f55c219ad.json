{
  "problem_type": "Rust测试代码unwrap修复方法论",
  "content": "## 问题重述\n在Rust项目中，测试代码常使用unwrap()处理错误，但这种方式在测试失败时缺乏有用的错误信息，给调试带来困难。需要将unwrap()改为expect()并提供上下文信息。\n\n## 可复用解决流程\n\n### 步骤1：定位需要修复的unwrap调用\n```bash\n# 搜索测试文件中的unwrap调用\nrg -n 'unwrap()' src/ --type rust | grep -E '(test|#[test])' -A2 -B2\n\n# 按行号精确定位\nrg -n 'unwrap()' path/to/file.rs\n```\n\n### 步骤2：分析每个unwrap的上下文\n使用工具：\n- read_code - 查看指定行号的代码上下文\n- 重点关注测试函数（以#[test]标记）中的unwrap调用\n\n### 步骤3：制定expect错误信息\n为每个unwrap调用设计有意义的错误信息：\n- 格式：`expect(\\\"操作描述 failed: {具体上下文}\\\")`\n- 示例：`expect(\\\"udp socket bind failed on address {}\\\", addr)`\n\n### 步骤4：验证修改结果\n```bash\n# 检查特定行号是否已修复\nrg -n 'expect(' path/to/file.rs | grep -E '(行号列表)'\n\n# 确保代码能编译\ncargo check --tests\n\n# 运行测试验证错误信息\ncargo test --test 模块名\n```\n\n## 注意事项\n1. **保持测试逻辑不变**：仅修改错误处理方式，不改变业务逻辑\n2. **错误信息要具体**：避免使用通用信息如\\\"operation failed\\\"\n3. **验证行号准确性**：任务指定的行号可能有偏移，需要实际检查确认\n4. **测试覆盖**：修复后应运行相关测试确保功能正常\n\n## 可选步骤\n- 使用cargo clippy检查是否还有其他unwrap警告\n- 考虑为生产代码使用更健壮的错误处理（如Result传播）\n- 建立代码审查规范，要求新增测试代码使用expect而非unwrap"
}