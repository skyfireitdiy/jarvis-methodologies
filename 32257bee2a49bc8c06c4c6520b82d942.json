{
  "problem_type": "ABI合规结构体返回值处理",
  "content": "问题重述：\n处理C编译器中结构体按值返回时的寄存器传递逻辑，需符合AMD64 System V ABI规范，正确处理浮点/整型成员的偏移和大小。\n\n可复用解决流程：\n1. **语义验证**：确认has_flonum类函数的返回值定义（true=包含/不包含）\n2. **边界对齐**：检查所有size边界(0,4,8,12,16)的处理逻辑\n3. **寄存器分配**：实现gp/fp计数器，正确选择xmm0-7和rax/rdx寄存器\n4. **测试矩阵**：\n   - 基本类型：float(4B)、double(8B)、int(4B)、long(8B)\n   - 组合场景：纯浮点结构、纯整型结构、混合结构\n   - 边界值：size=0、size>8、size>16\n5. **验证工具链**：\n   - cargo test验证单元测试\n   - 原始C代码交叉验证行为一致性\n\n注意事项：\n- 必须逐字节处理8字节以上结构体（避免memcpy优化）\n- 浮点断言需检查size==4或size>=8\n- 零大小结构体需特殊处理（不生成mov指令）\n- 保持与原始C代码的指令级一致性\n\n可选步骤：\n- 集成到完整编译器测试套件\n- 性能基准测试验证\n- 不同平台的ABI兼容性测试"
}