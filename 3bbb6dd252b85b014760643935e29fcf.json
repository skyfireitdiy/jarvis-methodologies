{
  "problem_type": "C到Rust TDD转换",
  "content": "## C到Rust TDD转换方法论\n\n### 问题重述\n将C语言项目中的关键函数（如main函数）转换为Rust实现，要求使用TDD（测试驱动开发）方法，保持行为等价。\n\n### 可复用解决流程\n\n#### 阶段1：分析阶段\n1. **项目结构分析**\n   - 使用`read_code`读取C源码\n   - 使用`lsp_client`分析符号依赖关系\n   - 使用`read_symbols`检查转换状态\n\n2. **依赖映射**\n   - 列出所有C函数调用\n   - 标记已转换和未转换的符号\n   - 确定Rust等效实现方案\n\n#### 阶段2：测试设计阶段\n1. **行为边界识别**\n   - 正常路径（正常参数）\n   - 边界路径（边界参数）\n   - 错误路径（错误处理）\n   - 交互路径（用户输入）\n\n2. **测试用例设计**\n   - CLI模式测试\n   - 交互模式测试\n   - 命令解析测试\n   - 全局状态测试\n\n#### 阶段3：实现阶段\n1. **框架搭建**\n   ```rust\n   #[cfg(test)]\n   mod tests {\n       use super::*;\n      \n       #[test]\n       fn test_xxx() { }\n   }\n   ```\n\n2. **渐进式实现**\n   - 空实现占位\n   - 逐步填充功能\n   - 持续运行测试验证\n\n3. **Rust化改造**\n   - 使用Rust原生类型\n   - 用RAII替换手动内存管理\n   - 用Result替换错误码\n\n#### 阶段4：验证阶段\n1. **编译验证**：`cargo check`\n2. **测试验证**：`cargo test`\n3. **行为验证**：关键功能手动测试\n\n### 注意事项\n- **导入路径处理**：bin目录使用`ushell_client_rs::`前缀\n- **测试阻塞处理**：使用条件编译或mock\n- **全局变量**：使用`Atomic*`或`OnceLock`\n- **错误处理**：使用`Result<T, E>`而非整数返回码\n\n### 可选步骤\n- 性能基准测试\n- 内存使用分析\n- 跨平台兼容性验证"
}