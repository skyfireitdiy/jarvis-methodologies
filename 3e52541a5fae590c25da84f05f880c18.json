{
  "problem_type": "Rust测试假阳性诊断与修复",
  "content": "# Rust测试假阳性诊断与修复方法论\n\n## 问题重述\n当Rust测试显示失败，但代码逻辑看似正确时，可能遇到测试假阳性(false positive)问题。这类问题通常由以下原因导致：\n- 并发测试竞态条件\n- 全局状态污染\n- 测试环境临时异常\n- 测试顺序依赖\n\n## 可复用解决流程\n\n### 第1步：隔离验证\n**目标**：确认是否为假阳性\n```bash\n# 单独运行失败的测试用例\ncargo test -- --nocapture <测试用例名称>\n\n# 多次运行确认稳定性\nfor i in {1..5}; do cargo test <测试用例名称>; done\n```\n\n### 第2步：状态清理\n**目标**：排除全局状态污染\n```bash\n# 清理所有构建缓存\ncargo clean\n\n# 重新运行完整测试\ncargo test -- --nocapture\n```\n\n### 第3步：并发测试检查\n**目标**：验证并发安全性\n```bash\n# 使用单线程运行测试\ncargo test -- --test-threads=1\n\n# 对比多线程运行结果\ncargo test\n```\n\n### 第4步：环境重置\n**目标**：确保环境纯净\n```bash\n# 重置到安全提交点\ngit reset --hard <安全commit>\n\n# 重新构建和测试\ncargo build && cargo test\n```\n\n### 第5步：调试信息添加\n**目标**：定位具体问题\n```rust\n// 在测试中添加调试输出\n#[test]\nfn test_example() {\n    println!(\"调试信息: {:?}\", 关键变量);\n    // 原始测试逻辑...\n}\n```\n\n## 注意事项\n1. **不要立即修改代码**：先确认是否为环境问题\n2. **记录重现步骤**：便于后续分析\n3. **检查全局状态**：特别注意Mutex、static变量等\n4. **验证边界条件**：空值、并发、资源清理等\n\n## 可选步骤\n- 检查CI/本地环境差异\n- 验证依赖版本一致性\n- 使用valgrind等工具检查内存问题"
}