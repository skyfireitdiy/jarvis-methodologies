{
  "problem_type": "基于Git变更生成Release Note和推广文案",
  "content": "## 问题重述\n需要根据Git仓库中两个版本（如最新tag到HEAD）之间的代码变更，自动生成结构化的Release Note和多种风格的推广文案。\n\n## 最优解决方案\n1. **检查工作区状态**: 使用`execute_script`工具执行 `git status --porcelain` 命令，检查并确保没有未提交的变更。\n   - 目的: 确保即将分析的代码是完整的，避免遗漏\n2. **（可选）提交变更**: 如果上一步发现有未提交的代码，根据情况判断是否需要提交。如果项目有自动化提交脚本（如 `jgc`），可以使用 `execute_script` 调用。\n   - 目的: 将所有相关变更纳入版本历史\n3. **获取最新Tag**: 使用`execute_script`工具执行 `git describe --tags \\`git rev-list --tags --max-count=1\\`` 命令，获取最近的一个版本号作为比较基准。\n4. **获取当前日期**: 使用`execute_script`工具执行 `date +\"%Y-%m-%d\"` 命令，获取当前日期用于Release Note标题。\n5. **提取代码变更详情**: 结合上一步获取的Tag，使用`execute_script`执行 `git diff <tag>..HEAD | cat -` 命令，获取从最新Tag到HEAD的所有代码修改详情。\n   - 关键: 提供完整的`git diff`输出给AI，远比`git log`更有效，这是保证生成内容质量的核心\n6. **AI分析并生成内容**: 将版本号、日期以及上一步获取的完整`git diff`内容提供给大语言模型，并使用结构化的提示词，要求其完成以下任务：\n   - 分析`git diff`内容，将变更分类为\"新功能(Features)\"、\"修复(Fixes)\"、\"优化与重构(Refactors & Improvements)\"、\"文档更新(Documentation)\"、\"其他(Miscellaneous)\"\n   - 根据分类结果，生成指定Markdown格式的Release Note\n   - 根据发布内容，创作多种不同风格（如专业、活泼、商务、极简）的推广文案\n\n## 注意事项\n- **使用`git diff`而非`git log`**: 为了让AI能深入理解变更内容，提供完整的`git diff`输出远比仅提供`git log`的提交信息更有效。这是保证生成内容质量的关键。\n- **上下文窗口限制**: 如果版本间的`diff`内容过大，可能会超出模型的上下文限制。在这种情况下，可以考虑使用`git log --stat`作为备选方案，但会牺牲内容生成的质量。\n- **提示词设计**: 生成内容的质量高度依赖于提交给AI的提示词。提示词中应包含清晰的格式要求、分类指导和风格示例。\n- **工作区清洁**: 在执行`git diff`之前，确保本地分支已经更新到最新的远程状态（`git pull`），这样才能包含所有协作者的提交。\n- **人工审查**: 生成的Release Note初稿应由人工审查和微调，以确保其准确性和专业性。\n\n## 可选步骤\n- **自动化脚本**: 可以编写脚本自动执行上述流程，减少人工干预\n- **模板定制**: 根据不同项目特点，定制Release Note模板和推广文案风格\n- **多语言支持**: 如需国际化，可生成多语言版本的Release Note\n- **社交媒体适配**: 针对不同平台（微博、Twitter、LinkedIn）优化推广文案长度和格式"
}