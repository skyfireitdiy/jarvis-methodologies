{
  "problem_type": "C到Rust函数迁移",
  "content": "基于TDD的C到Rust函数迁移方法\n\n问题重述\n如何将C函数安全、正确地迁移到Rust，同时保持语义等价性和Rust惯用法\n\n可复用解决流程\n\n1. Red阶段：编写测试\n   - 在目标Rust模块中添加#[cfg(test)] mod tests测试模块\n   - 基于C函数行为设计完整测试用例：边界值、错误情况、正常情况\n   - 确保测试可编译通过（此时函数可能未实现）\n\n2. Green阶段：实现函数\n   - 分析C函数签名，映射到Rust类型系统\n   - 实现函数逻辑，使用Rust惯用法：\n     - long long → i64\n     - int → i32  \n     - 保持错误处理语义（如C的-1错误值）\n     - 使用Rust循环结构替代C循环\n   - 运行cargo test验证实现正确性\n\n3. Refactor阶段：优化代码\n   - 修复编译警告（如未使用变量用_i前缀）\n   - 添加中文注释和文档注释\n   - 确保代码符合Rust惯用法和项目规范\n   - 再次运行测试确保功能完整性\n\n注意事项\n- 严格遵循TDD流程：测试先行\n- 使用Rust原生类型，避免extern \"C\"\n- 保持与C函数的语义等价性\n- 最小变更原则，避免无关重构\n- 使用pub修饰符确保函数可访问\n- 注释使用中文，禁止use ...::*通配导入\n\n可选步骤\n- 如果函数有依赖，先实现底层依赖函数\n- 检查lib.rs是否需要导出新函数\n- 使用git进行分步骤提交，保持可回退性"
}