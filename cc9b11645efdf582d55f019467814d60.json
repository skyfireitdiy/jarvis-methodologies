{
  "problem_type": "rust_module_reverse_engineering",
  "content": "# Rust 模块反向工程分析\n\n## 规则简介\n\n本方法论用于对 Rust 项目的模块进行深度反向工程分析，提取设计信息并生成语言无关的设计方案文档。适用于理解现有代码库、生成技术文档、重构规划等场景。\n\n## 你必须遵守的原则\n\n### 分析完整性原则\n\n**要求说明：**\n\n- **必须**：读取模块的所有核心源文件，不能仅依赖部分文件\n- **必须**：识别所有公共接口、数据结构、核心函数和类型\n- **必须**：分析模块的依赖关系（内部依赖和外部依赖）\n- **禁止**：根据文件名或目录结构猜测模块功能，必须基于实际代码\n\n### 文档结构化原则\n\n**要求说明：**\n\n- **必须**：生成的文档必须包含模块概述、核心功能、组件分析、依赖关系等标准章节\n- **必须**：使用清晰的层次结构（##、###）组织内容\n- **必须**：记录代码来源（文件路径、行数、代码统计）\n- **禁止**：生成纯文本的代码复制，必须提炼为设计说明\n\n### 语言无关原则\n\n**要求说明：**\n\n- **必须**：使用通用的设计术语，避免 Rust 特定语法的过度描述\n- **必须**：聚焦设计模式和架构决策，而非实现细节\n- **必须**：提供功能对照表验证完整性\n- **禁止**：直接粘贴大量代码片段\n\n## 你必须执行的操作\n\n### 阶段1：信息收集\n\n1. **模块结构扫描**：\n   - 列出模块的所有源文件（.rs 文件）\n   - 记录文件路径和代码行数\n   - 识别模块入口文件（mod.rs/lib.rs）\n\n2. **核心文件读取**：\n   - 读取模块入口文件，理解模块组织\n   - 读取所有核心实现文件，识别公共接口\n   - 读取测试文件（如果存在），理解使用场景\n\n3. **关键信息提取**：\n   - 模块职责和目标\n   - 核心功能和操作\n   - 数据结构和类型定义\n   - 依赖的外部模块和库\n\n### 阶段2：分析设计\n\n1. **模块结构分析**：\n   - 识别子模块和组件\n   - 分析组件之间的职责划分\n   - 绘制模块组织结构图\n\n2. **核心功能分析**：\n   - 列出所有公开的公共接口\n   - 说明每个接口的功能和参数\n   - 识别设计模式的应用\n\n3. **依赖关系分析**：\n   - 内部依赖（项目内其他模块）\n   - 外部依赖（第三方库和标准库）\n   - FFI 依赖（如果存在）\n   - 绘制依赖关系图\n\n4. **技术特性分析**：\n   - 并发控制机制（锁、原子类型等）\n   - 错误处理策略\n   - 线程安全保证\n   - 性能优化技术\n\n### 阶段3：文档生成\n\n1. **创建文档文件**：\n   - 在指定输出目录创建模块文档\n   - 文件名格式：{模块名}.md\n\n2. **编写文档内容**：\n   - **第1章：模块概述**：职责、目标、技术特性\n   - **第2章：核心功能**：功能列表、操作说明、使用场景\n   - **第3章：模块结构**：组织结构、核心组件、组件职责\n   - **第4章：依赖关系**：依赖树、外部依赖、FFI 依赖\n   - **第5章：接口设计**：公共接口、参数说明、返回值\n   - **第6章：技术细节**：并发控制、错误处理、FFI 集成等\n   - **第7章：代码来源**：文件列表、代码统计、依赖记录\n   - **第8章：设计模式**：使用的设计模式、最佳实践\n   - **第9章：使用示例**：典型使用场景示例\n   - **第10章：总结**：模块特点、优势、待改进点\n\n3. **验证文档完整性**：\n   - 检查所有预期章节是否完整\n   - 验证代码来源记录准确\n   - 确认功能覆盖无遗漏\n\n## 实践指导\n\n### 信息收集技巧\n\n1. **优先读取 mod.rs**：快速理解模块组织结构\n2. **关注 pub 关键字**：识别公共接口\n3. **阅读文档注释**：获取官方的功能说明\n4. **查看测试文件**：了解使用方式和边界情况\n\n### 分析要点\n\n1. **职责划分**：每个组件应该有明确的单一职责\n2. **接口设计**：接口应该简洁、清晰、易于使用\n3. **错误处理**：完整的错误类型定义和错误传播\n4. **线程安全**：明确说明并发控制机制\n\n### 文档编写建议\n\n1. **使用表格**：用于展示文件列表、依赖关系、错误码等结构化数据\n2. **添加代码示例**：通过示例说明接口使用方法\n3. **标记待分析部分**：明确标注不确定或需要进一步分析的内容\n4. **保持更新**：代码变更时及时更新文档\n\n## 检查清单\n\n- [ ] 已列出模块的所有源文件\n- [ ] 已读取所有核心实现文件\n- [ ] 已提取所有公共接口\n- [ ] 已分析模块职责和目标\n- [ ] 已识别核心组件及其职责\n- [ ] 已分析依赖关系（内部、外部、FFI）\n- [ ] 已说明并发控制机制\n- [ ] 已说明错误处理策略\n- [ ] 已记录代码来源（文件路径、行数）\n- [ ] 已生成结构化文档\n- [ ] 已验证文档完整性\n- [ ] 已提供使用示例",
  "scope": "global"
}