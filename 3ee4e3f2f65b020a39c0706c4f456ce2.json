{
  "problem_type": "UTF-16字符串解析测试增强",
  "content": "# UTF-16字符串字面量转义字符解析测试方法论\n\n## 问题重述\n为UTF-16字符串字面量转义字符解析功能添加全面单元测试，包括边界情况和错误场景，达到90%以上测试覆盖率。\n\n## 可复用解决流程\n\n### 第一阶段：需求分析和基线建立\n1. **功能分解**\n   - 转义字符解析：标准C转义、Unicode转义、八进制、十六进制\n   - UTF-16编码转换：ASCII、BMP字符、代理对、边界值\n   - 集成测试：完整字符串字面量解析流程\n   - 错误处理：无效转义、编码错误、边界异常\n\n2. **现有测试评估**\n   - 使用 `cargo test` 获取当前测试状态和失败情况\n   - 使用 `rg '#\\\\[test\\\\]' src/` 统计现有测试数量\n   - 识别测试覆盖缺口\n\n### 第二阶段：分层测试设计\n1. **转义字符解析测试层**（src/util/string.rs）\n   ```\n   测试类别：\n   - 标准C转义：\\\\n, \\\\t, \\\\r, \\\\b, \\\\a, \\\\v, \\\\f, \\\\0, \\\\\\\\, \\\\', \\\\\"\n   - 八进制转义：\\\\0-\\\\777\n   - 十六进制转义：\\\\x00-\\\\xFF\n   - Unicode转义：\\\\uXXXX, \\\\UXXXXXXXX\n   - 混合序列和边界值\n   - 错误场景：无效转义、EOF、格式错误\n   ```\n\n2. **UTF-16编码转换测试层**（src/util/string.rs）\n   ```\n   测试类别：\n   - ASCII字符（0x0000-0x007F）\n   - BMP字符（0x0080-0xFFFF，排除代理对区域）\n   - 代理对字符（0x10000-0x10FFFF）\n   - 边界值：0x0000, 0xD7FF, 0xE000, 0xFFFF, 0x10000, 0x10FFFF\n   - 空字符串和极端情况\n   ```\n\n3. **集成测试层**（src/lexer/tokenizer.rs）\n   ```\n   测试类别：\n   - 基本字符串字面量\n   - 包含转义字符的字符串\n   - 包含Unicode转义的字符串\n   - 包含emoji代理对的字符串\n   - 空字符串\n   - 多语言字符\n   - 错误处理场景\n   ```\n\n### 第三阶段：测试实现和验证\n1. **测试用例编写原则**\n   - 每个测试函数专注一个具体场景\n   - 使用描述性测试函数名\n   - 包含清晰的断言和错误消息\n   - 边界值测试要覆盖最小值、最大值、临界值\n\n2. **覆盖率验证**\n   - 运行完整测试套件：`cargo test`\n   - 统计测试函数数量确认覆盖完整性\n   - 验证所有主要功能路径都有对应测试\n\n### 第四阶段：边界条件修复\n1. **常见问题识别**\n   - Unicode转义格式错误（\\\\U vs \\\\u）\n   - 代理对计算边界条件\n   - EOF处理不当\n   - 无效字符编码处理\n\n2. **修复验证**\n   - 针对失败测试用例进行调试\n   - 补充边界条件测试\n   - 重新运行完整测试确认修复\n\n## 注意事项\n- 代理对计算需严格遵循Unicode标准\n- 错误处理要保持与C标准一致的行为\n- 测试用例应独立于具体实现细节\n- 大写Unicode转义(\\\\U)需要8位十六进制，小写(\\\\u)需要4位\n\n## 可选步骤\n- 使用性能测试验证大字符串处理效率\n- 添加模糊测试验证边界条件健壮性\n- 集成到CI/CD流程确保持续测试覆盖"
}