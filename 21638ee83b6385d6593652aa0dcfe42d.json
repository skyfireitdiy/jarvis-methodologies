{
  "problem_type": "修复Rust并发测试失败",
  "content": "# Rust并发测试失败修复方法论\n\n## 问题识别\n1. **PoisonError诊断**：检查是否由锁竞争引起\n2. **状态污染检测**：确认全局状态是否正确隔离\n3. **原子操作验证**：确保原子操作返回值逻辑正确\n\n## 修复流程\n1. **问题分析**：运行完整测试获取失败详情\n2. **并发诊断**：识别锁竞争点和状态污染源\n3. **原子操作修复**：修正fetch_add/fetch_sub返回值处理\n4. **状态隔离**：添加测试前后的状态重置机制\n5. **验证修复**：运行测试确认所有用例通过\n\n## 关键要点\n- 使用`Mutex`时要处理`PoisonError`\n- `Atomic*`操作的`fetch_add`返回旧值，`fetch_sub`也返回旧值\n- 测试间需要正确的状态隔离\n- 全局状态需要在测试前后重置\n\n## 验证标准\n- `cargo test -- --nocapture` 必须全部通过\n- 多次运行测试确认稳定性\n- 检查无状态污染导致的随机失败"
}