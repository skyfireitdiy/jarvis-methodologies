{
  "problem_type": "C到Rust函数TDD转译",
  "content": "# C到Rust函数TDD转译方法论\n\n## 问题重述\n将单个C函数转译为Rust实现，遵循测试驱动开发(TDD)原则，确保行为一致性。\n\n## 可复用解决流程\n\n### Phase 1: INTENT（需求澄清）\n- 确认C函数完整源码和签名\n- 识别所有参数类型和返回值\n- 确定边界情况和错误处理行为\n- 锁定目标Rust文件位置\n\n### Phase 2: RESEARCH（上下文分析）\n- 读取并分析目标Rust文件当前状态\n- 检查是否已有类似实现（如reg_dx存在）\n- 确认测试模块结构和现有测试风格\n\n### Phase 3: INNOVATE（方案设计）\n- 设计Rust函数签名（使用原生类型）\n- 规划测试用例覆盖：\n  * 主要功能路径（1,2,4,8字节）\n  * 边界情况（0,3,16等非法值）\n  * panic行为验证\n- 保持与现有代码风格一致\n\n### Phase 4: PLAN（执行计划）\n1. Red：在`#[cfg(test)] mod tests`中添加测试用例\n2. Green：在测试模块外实现函数\n3. 运行`cargo test <函数名>`验证\n\n### Phase 5: EXECUTE（实施）\n- 测试用例编写技巧：\n  - 使用`#[should_panic]`验证panic行为\n  - 测试名称清晰描述场景\n  - 断言使用`assert_eq!`验证返回值\n- 函数实现要点：\n  - 使用`match`表达式映射值\n  - 保持与C行为一致的panic处理\n  - 添加完整文档注释（含示例）\n\n### Phase 6: REVIEW（验证）\n- 所有测试通过\n- 检查编译警告\n- 确认代码风格一致性\n- 验证文档示例正确性\n\n## 注意事项\n- 禁止修改现有测试用例，除非确实需要\n- panic消息需包含明确错误信息\n- 文档注释需包含示例代码\n- 保持最小变更原则\n\n## 可选步骤\n- 运行完整测试套件验证无回归\n- 检查是否需要集成到公共API\n- 考虑性能优化（如有必要）"
}