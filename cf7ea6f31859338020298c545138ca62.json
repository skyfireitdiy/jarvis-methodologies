{
  "problem_type": "任务完成验证",
  "content": "# 任务完成验证方法论\n\n## 规则简介\n\n本方法论用于系统化验证开发任务是否真正完成，确保所有预期输出都有对应的实际产物支撑。适用于代码实现、测试编写、文档更新等各类开发任务的验证。\n\n## 你必须遵守的原则\n\n### 原则1：基于实际验证，禁止推测\n\n**要求说明：**\n\n- **必须**：使用工具（read_code、execute_script等）获取实际验证结果\n- **必须**：基于实际执行结果进行判断\n- **禁止**：推测、假设或虚构任何验证结果\n- **禁止**：在未实际验证的情况下判定任务完成\n\n### 原则2：逐条验证预期输出\n\n**要求说明：**\n\n- **必须**：将预期输出解析为具体的条目列表\n- **必须**：对每一条预期输出分别进行验证\n- **必须**：明确标记每条的验证状态（PASSED/FAILED）\n- **禁止**：跳过任何一条预期输出的验证\n- **禁止**：仅验证部分条目就判定整体完成\n\n### 原则3：仅验证任务相关产物\n\n**要求说明：**\n\n- **必须**：聚焦于任务描述中明确要求的交付物\n- **必须**：验证预期输出中列出的具体产物\n- **禁止**：验证与任务无关的项目状态（如整体编译、无关测试等）\n- **禁止**：扩大验证范围到任务范围之外\n\n## 你必须执行的操作\n\n### 阶段1：解析预期输出\n\n1. **提取预期输出**：从任务描述中找到\"预期输出\"部分\n2. **解析为条目列表**：按换行、编号（1)、2)、3)）或markdown列表（- item）切分为独立条目\n3. **理解每条要求**：明确每条预期输出的具体含义和验证标准\n\n### 阶段2：逐条验证产物\n\n对每一条预期输出条目执行以下步骤：\n\n1. **确定验证方法**：\n   - 文件存在性：使用read_code读取文件\n   - 代码实现：使用read_code检查类、方法、函数等\n   - 测试用例：使用read_code统计测试数量\n   - 功能正确性：使用execute_script运行测试\n   - 代码质量：使用execute_script运行linter（如ruff、mypy）\n   - 覆盖率：使用execute_script运行pytest-cov\n\n2. **执行验证**：使用相应工具获取实际结果\n\n3. **判断结果**：\n   - 如果产物存在且符合要求：标记为PASSED\n   - 如果产物不存在、不完整或不符合要求：标记为FAILED，记录具体原因\n\n### 阶段3：汇总验证结果\n\n1. **检查整体状态**：\n   - 所有条目都PASSED：任务完成\n   - 任何条目FAILED：任务未完成\n\n2. **输出验证报告**：\n   - 如果任务完成：输出`<!!!COMPLETE!!!>`\n   - 如果任务未完成：详细说明每条FAILED条目的原因\n\n## 实践指导\n\n### 常见验证场景\n\n**代码实现验证：**\n- 使用read_code读取实现文件\n- 检查类名、方法名是否符合要求\n- 验证关键方法的存在性\n- 检查是否实现了必需的功能\n\n**测试验证：**\n- 使用read_code或grep统计测试用例数量\n- 使用pytest运行测试，检查是否全部通过\n- 使用pytest-cov检查测试覆盖率\n\n**代码质量验证：**\n- 使用ruff检查代码风格\n- 使用mypy检查类型注解\n- 检查是否有语法错误\n\n### 常见错误\n\n1. **过度验证**：验证了任务范围之外的内容\n2. **验证不足**：跳过了某些预期输出条目\n3. **推测结果**：未实际执行验证就假设结果\n4. **标准不一致**：对不同条目使用了不同的验证标准\n\n### 注意事项\n\n- 验证顺序：先验证基础产物（文件存在），再验证高级要求（功能、质量）\n- 依赖关系：如果基础验证失败，可能无需继续验证依赖项\n- 错误处理：工具执行失败时，应记录错误信息并标记为FAILED\n- 性能考虑：避免重复执行相同的验证操作\n\n## 检查清单\n\n验证完成后，确认以下事项：\n\n- [ ] 已解析所有预期输出条目\n- [ ] 每条预期输出都已实际验证\n- [ ] 每条验证都有明确的PASSED/FAILED标记\n- [ ] FAILED条目都有详细的失败原因\n- [ ] 未验证任务范围之外的内容\n- [ ] 所有验证都基于实际执行结果\n- [ ] 已输出最终验证结论（完成或未完成）",
  "scope": "global"
}