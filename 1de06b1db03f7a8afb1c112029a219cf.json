{
  "problem_type": "远程服务器文件下载故障排查",
  "content": "# 远程服务器文件下载故障排查方法论\n\n## 问题重述\n当从远程服务器下载文件或目录时遇到连接失败、权限拒绝或网络不可达等问题，需要系统性地排查和解决。\n\n## 最优解决方案\n1. **网络连通性验证** (工具: execute_script)\n   - 使用 `ping -c 3 <服务器IP>` 测试基础网络连通性\n   - 使用 `timeout 5 bash -c \"</dev/tcp/<IP>/<端口>\"` 验证目标端口可达性\n   - 使用 `traceroute -n <服务器IP>` 分析网络路径\n\n2. **SSH服务状态确认** (工具: execute_script)\n   - 确认SSH服务端口（默认22）是否开放\n   - 验证用户名/密码或SSH密钥认证配置\n   - 检查是否有VPN或内网连接要求\n\n3. **权限和路径验证** (工具: virtual_tty)\n   - 使用SSH登录验证实际文件路径存在性\n   - 确认用户权限足够访问目标目录\n   - 检查文件系统权限和SELinux/AppArmor限制\n\n4. **下载方案选择** (工具: execute_script/virtual_tty)\n   - **SCP方案**: `sshpass -p '密码' scp -r 用户@IP:路径 ./`\n   - **SFTP方案**: `sftp 用户@IP` 交互式传输\n   - **rsync方案**: `rsync -avz 用户@IP:路径 ./`\n   - **HTTP方案**: 检查是否有Web下载方式\n\n5. **错误处理和重试** (工具: execute_script)\n   - 设置合理的超时时间避免长时间等待\n   - 添加重试机制处理临时性网络问题\n   - 记录详细的错误日志便于分析\n\n## 注意事项\n1. **网络环境差异**: 企业内网、VPN、跳板机等特殊网络环境需要额外配置\n2. **认证方式**: 密码认证可能不如密钥认证稳定，优先使用SSH密钥\n3. **大文件传输**: 大文件建议使用rsync或分块传输，避免网络中断\n4. **权限问题**: 注意文件系统权限、防火墙规则和SELinux策略\n5. **安全考虑**: 避免在命令行中明文暴露密码，使用环境变量或配置文件\n\n## 可选步骤\n1. **压缩传输**: 对于大量小文件，先在服务器压缩再传输\n2. **断点续传**: 使用rsync的--partial参数支持断点续传\n3. **代理转发**: 通过跳板机进行多级SSH转发\n4. **Web替代**: 如果SSH不可用，检查是否有WebDAV或其他Web接口"
}