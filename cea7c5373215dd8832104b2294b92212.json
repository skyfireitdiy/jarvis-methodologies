{
  "problem_type": "从虚拟环境安装到全局工具安装迁移",
  "content": "## 问题重述\n当需要将 Python 包从虚拟环境安装方式（如 uv pip install / pip install）改为全局工具安装方式（如 uv tool install / pipx install）时，需要系统性地修改安装脚本和配置。\n\n## 可复用解决流程\n\n### 1. 分析当前安装方式\n- 定位安装脚本文件（如 install.sh, setup.py）\n- 识别虚拟环境创建和激活逻辑\n- 找出所有引用虚拟环境变量的位置（如 VENV_DIR）\n- 确认包的入口点定义（entry_points / console_scripts）\n\n### 2. 修改安装命令\n- 将 `uv pip install <package>` 改为 `uv tool install <package>`\n- 将 `pip install <package>` 改为 `pipx install <package>`\n- 处理可选依赖：`uv tool install \".[extra]\"`\n- 删除虚拟环境创建命令（uv venv / python -m venv）\n\n### 3. 清理虚拟环境相关代码\n- 删除虚拟环境变量定义（VENV_DIR 等）\n- 删除虚拟环境创建和检查逻辑\n- 删除虚拟环境激活命令（source VENV_DIR/bin/activate）\n- 删除 Shell 配置文件修改逻辑（.bashrc, .zshrc 等）\n\n### 4. 更新用户提示信息\n- 简化安装完成提示：无需提示激活虚拟环境\n- 改为全局可用的提示信息\n- 保留功能选项（如 RAG 功能安装）\n\n### 5. 调整自动补全安装\n- 移除虚拟环境激活步骤\n- 直接使用全局安装的工具命令\n- 确保工具命令在 PATH 中可用\n\n### 6. 验证安装流程\n- 检查语法正确性\n- 测试全局安装命令是否可用\n- 验证所有工具入口点正确注册\n\n## 注意事项\n\n### uv tool install 特性\n- 自动将可执行文件安装到 uv 管理的全局目录\n- 无需手动激活虚拟环境即可使用\n- 工具自动隔离，避免依赖冲突\n- 支持 `uv tool list` 和 `uv tool uninstall` 管理\n\n### 兼容性考虑\n- 确保用户的 PATH 包含 uv 的工具目录（通常在 ~/.local/bin 或 ~/.cargo/bin）\n- 考虑回退方案：如果全局安装失败，是否保留虚拟环境选项\n- 注意权限问题：全局安装可能需要适当的权限配置\n\n### 用户影响\n- 用户无需修改 rc 文件（.bashrc, .zshrc 等）\n- 安装后命令立即可用，无需重启 shell\n- 卸载更简单：`uv tool uninstall <package>`\n\n### 最佳实践\n- 优先使用 `uv tool install` 替代 `uv pip install` 进行 CLI 工具安装\n- 对于库开发，仍可使用虚拟环境进行开发测试\n- 在 CI/CD 环境中，全局安装可以简化配置\n\n## 可选步骤\n\n### 配置安装镜像\n```bash\nexport UV_PYTHON_INSTALL_MIRROR=\"https://python-standalone.org/mirror/astral-sh/python-build-standalone/\"\n```\n\n### 指定安装目录\n```bash\nexport UV_TOOL_DIR=\"$HOME/.local/share/uv/tools\"\nexport UV_BIN_DIR=\"$HOME/.local/bin\"\n```\n\n### 禁用修改 rc 文件（uv 自身安装时）\n```bash\ncurl -LsSf https://astral.sh/uv/install.sh | env UV_NO_MODIFY_PATH=1 sh\n```\n\n## 适用场景\n- 将命令行工具从虚拟环境安装改为全局安装\n- 简化用户安装和配置流程\n- 减少环境配置的复杂性\n- 改善用户体验（无需记住激活命令）",
  "scope": "global"
}