{
  "problem_type": "TUI应用验证",
  "content": "TUI应用验证方法论\n\n问题重述：\n验证基于Textual等TUI框架的应用是否正确实现，特别是涉及组件生命周期、挂载时序的问题。需要确保应用能正常启动、显示内容、交互功能正常。\n\n可复用解决流程：\n\n1. 静态语法检查\n   - 工具：python3 -m py_compile\n   - 目标：确保代码无语法错误\n   - 预期：无错误输出\n\n2. 代码逻辑验证（重点检查组件生命周期）\n   - 工具：read_code 读取源码\n   - 检查点：\n     * compose() 方法是否只返回容器结构，不执行挂载操作\n     * on_mount() 方法是否在容器挂载后才填充内容\n     * 是否使用 query_one() 获取已挂载容器\n     * 是否保留了所有原有功能逻辑\n   - Textual框架生命周期关键点：\n     * compose() 返回的组件会被框架自动挂载\n     * on_mount() 在所有compose()组件挂载完成后调用\n     * query_one() 只能查询已挂载的组件\n\n3. 应用初始化测试\n   - 编写测试脚本创建应用实例\n   - 检查 app 初始化是否成功\n   - 验证 compose() 返回组件数量\n   - 确认没有 MountError 或其他运行时异常\n   - 示例代码结构：\n     ```python\n     app = SchemaFormApp(schema=..., defaults=..., title=...)\n     widgets = list(app.compose())\n     assert len(widgets) == expected_count\n     ```\n\n4. 命令启动测试\n   - 执行应用启动命令（如 jvs -I）\n   - 非交互式环境使用 timeout 限制运行时间\n   - 检查是否有启动错误、异常退出或崩溃\n   - 示例：timeout 2s jvs -I\n\n5. 功能验证（需要交互式环境或自动化测试）\n   - TUI 正常显示配置项\n   - 表单字段正确渲染\n   - 能够正确提交配置\n   - 验证逻辑正常工作（必填检查、类型验证等）\n\n注意事项：\n- MountError 是Textual框架常见错误，通常是由于在组件挂载前就尝试操作子组件\n- 非交互式环境无法完全测试交互功能，需要模拟或实际交互测试\n- 验证脚本应该快速执行并输出明确的结果（All tests passed 或具体错误）\n- 保持原有功能完整性，避免为了修复时序问题而简化或删除逻辑\n\n可选步骤：\n- 编写单元测试验证组件挂载逻辑\n- 使用虚拟终端（pty）进行自动化交互测试\n- 集成到CI/CD流程中，确保持续验证"
}