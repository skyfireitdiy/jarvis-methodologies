{
  "problem_type": "向现有代码库添加函数和测试",
  "content": "# 向现有代码库添加函数和测试的方法论\n\n## 问题重述\n需要将新函数及其相关测试准确地添加到现有代码文件中，避免重复、位置错误和结构破坏。\n\n## 可复用解决流程\n\n### 步骤1：预检查\n- 使用`lsp_client.search_symbol`确认目标函数是否已存在\n- 使用`read_code`读取文件末尾20行，确认最佳插入位置\n\n### 步骤2：代码定位\n- 确定插入点：通常选择文件末尾倒数第二行（倒数第一行可能是`}`）\n- 检查前后文关联：确认新函数依赖的其他函数/结构体的位置\n\n### 步骤3：增量添加\n1. 先添加核心函数（非测试代码）\n2. 验证语法正确性\n3. 再添加辅助函数（如`find_func`）\n4. 最后添加测试模块\n\n### 步骤4：验证完整性\n- 使用`lsp_client.search_symbol`确认所有符号已正确注册\n- 使用`read_code`检查代码完整性和格式一致性\n- 确认测试模块的`#[cfg(test)]`属性正确\n\n### 注意事项\n- Rust项目中，测试函数必须标记`#[test]`\n- 测试模块使用`mod tests { use super::*; }`结构\n- 避免在文件末尾重复添加已存在的函数\n- 确保新代码遵循项目的命名和缩进规范\n\n### 可选步骤\n- 如果涉及多个文件，创建临时备份\n- 使用`execute_script`运行`cargo test`验证测试通过"
}