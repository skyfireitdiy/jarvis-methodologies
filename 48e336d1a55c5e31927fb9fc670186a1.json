{
  "problem_type": "基于Git变更生成Release Note",
  "content": "## 基于Git变更生成Release Note和推广文案\n\n### 问题重述\n需要根据Git仓库中最新Tag到当前HEAD之间的代码变更，自动生成一份结构化的Release Note和多种风格的社交媒体推广文案。\n\n### 最优解决方案\n1. **检查工作区状态**: 使用`execute_script`工具执行 `git status --porcelain` 命令，检查是否存在未提交的变更。\n   - 目的: 确保即将分析的代码是完整的，避免遗漏。\n2. **（可选）提交变更**: 如果上一步发现有未提交的代码，根据情况判断是否需要提交。如果项目有自动化提交脚本（如 `jgc`），可以使用 `execute_script` 调用。\n   - 目的: 将所有相关变更纳入版本历史。\n3. **获取当前最新Tag**: 使用`execute_script`工具执行 `git describe --tags \\`git rev-list --tags --max-count=1\\`` 命令，获取最近的一个版本号。\n   - 目的: 确定代码变更的比较起点。\n4. **确认新版本号**: \n   - 使用`ask_user`工具与用户确认新版本号\n   - 明确说明当前最新tag版本，询问下一个版本的版本号\n   - 必须得到用户明确确认后才能继续\n5. **获取当前日期**: 使用`execute_script`工具执行 `date +\"%Y-%m-%d\"` 命令，获取当前日期。\n   - 目的: 用于Release Note的时间戳。\n6. **提取代码变更详情**: 结合上一步获取的Tag，使用`execute_script`执行 `git diff <tag>..HEAD | cat -` 命令，获取从最新Tag到HEAD的所有代码修改详情。\n   - 目的: 为内容生成提供原始素材。\n7. **分析并生成内容**: 综合所有获取到的信息（新版本号、日期、代码变更diff），由大模型分析这些变更，并按照指定的格式生成Release Note和多风格推广文案。\n   - 目的: 产出最终交付物。\n\n### 注意事项\n- **版本号确认是关键步骤**: 必须明确当前tag版本与新版本号的关系，避免版本号错误\n- **使用`git diff`而非`git log`**: 为了让AI能深入理解变更内容，提供完整的`git diff`输出远比仅提供`git log`的提交信息更有效。这是保证生成内容质量的关键。\n- **上下文窗口限制**: 如果版本间的`diff`内容过大，可能会超出模型上下文限制。在这种情况下，可以考虑使用 `git log --pretty=format:\"%s\"` 等命令生成更简洁的提交信息列表作为替代输入。\n- **生成的Release Note初稿应由人工审查和微调**，以确保其准确性和专业性。\n- **工作区清洁**: 在执行`git diff`之前，确保本地分支已经更新到最新的远程状态（`git pull`），这样才能包含所有协作者的提交。\n\n### 可选步骤\n- **自动化脚本**: 可以编写脚本自动执行上述流程，减少人工干预\n- **模板定制**: 根据不同项目特点，定制Release Note模板和推广文案风格\n- **多语言支持**: 如需国际化，可生成多语言版本的Release Note\n- **社交媒体适配**: 针对不同平台（微博、Twitter、LinkedIn）优化推广文案长度和格式"
}