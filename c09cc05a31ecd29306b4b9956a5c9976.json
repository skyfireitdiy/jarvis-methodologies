{
  "problem_type": "C++清理函数系统调用错误处理",
  "content": "**问题重述**：C++清理函数中系统调用（如close、fclose、munmap等）返回值未检查，可能导致资源泄漏或错误静默忽略。\n\n**可复用解决流程**：\n1. **定位问题**：检查清理函数中所有系统调用\n   - 使用工具：`rg \\\"close\\\\(|fclose\\\\(|munmap\\\\(\\\" base/src/ -A 2 -B 2`\n   - 关注返回值为int的系统调用\n\n2. **修复原则**：\n   - 必须检查返回值\n   - 不能改变函数签名（如保持void返回类型）\n   - 错误处理不能阻止清理流程继续\n   - 使用项目现有日志宏记录警告\n\n3. **具体修复步骤**：\n   ```\n   // 修复前\n   void CleanUp() {\n       close(fd_);\n   }\n  \n   // 修复后\n   void CleanUp() {\n       if (fd_ != INVALID_FD) {\n           if (close(fd_) != 0) {\n               UTILS_LOGW(\"close fd_ failed in CleanUp\");\n   }\n           fd_ = INVALID_FD;\n   }\n   }\n   ```\n\n4. **验证检查**：\n   - 确认返回值已检查（if判断或错误码判断）\n   - 确认使用了适当的日志级别\n   - 确认清理流程会继续执行\n   - 确认API未改变\n\n**注意事项**：\n- 避免过度修复：如free/delete等操作不需要检查返回值\n- 保持代码风格一致性\n- 对于批量清理，单个失败不应影响其他资源的清理\n\n**可选步骤**：\n- 统计修复前后错误发现率\n- 添加单元测试验证错误路径处理"
}