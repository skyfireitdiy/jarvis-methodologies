{
  "problem_type": "Rust测试并发安全验证",
  "content": "问题重述：当Rust测试涉及全局状态（静态变量）时，在并发执行环境下会出现竞态条件，导致测试失败。\n\n可复用解决流程：\n1. **识别问题**：通过cargo test失败日志确认是否为并发导致的全局状态竞态条件\n2. **添加测试锁**：\n   - 在测试模块顶部添加：use std::sync::Mutex;\n   - 定义全局锁：static TEST_LOCK: Mutex<()> = Mutex::new(());\n3. **应用锁保护**：\n   - 遍历所有测试函数，识别涉及全局状态的测试\n   - 在每个测试函数开头添加：let _guard = TEST_LOCK.lock().unwrap();\n4. **验证修复**：\n   - 运行cargo test确保所有测试通过\n   - 多次运行cargo test确认并发环境下稳定性\n5. **代码审查**：\n   - 检查是否有遗漏的测试函数未加锁保护\n   - 确保锁的使用模式一致\n\n注意事项：\n- 锁保护应覆盖所有涉及全局状态的测试函数\n- 锁变量命名建议统一为TEST_LOCK以便识别\n- 使用let _guard模式确保锁在函数结束时自动释放\n\n可选步骤：\n- 可创建测试辅助宏简化锁使用\n- 可考虑使用lazy_static或once_cell优化锁初始化"
}